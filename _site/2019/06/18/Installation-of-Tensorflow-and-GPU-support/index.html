<p>In this post, you will see how to install tensorflow and GPU support. I assume that you don’t have a root permision.</p>

<p>Of course, this post is just a test file for my Github Pages. You can find a lot of articles like this from Google.</p>

<p>Here is some details about my OS and environment.</p>
<ul>
  <li>CentOS 7 (BTW, here I only talk about linux system.)</li>
  <li>anaconda3 Anaconda is a goog tool to manage your enviroment. You can get more information in its <a href="https://www.anaconda.com/">offcial website</a></li>
  <li>nvidia-driver 410.79 Dependence for <a href="https://developer.nvidia.com/cuda-toolkit">CUDA</a> and <a href="https://developer.nvidia.com/cudnn">CuDNN</a></li>
</ul>

<h2 id="create-a-new-enviroment">Create a new enviroment</h2>
<ul>
  <li>I suppose that you have already had anaconda3 installed. Then, you can run the command below to create an enviroment, where the name of it is tensorflow and version of python we use is 3.7.
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda create <span class="nt">--name</span> tensorflow <span class="nv">python</span><span class="o">=</span>3.7
</code></pre></div>    </div>
    <p>After that you have created a new enviroment. Then you can activate it and do something.</p>
  </li>
</ul>

<h2 id="install-tensorflow">Install Tensorflow</h2>
<ol>
  <li>First, activate the enviroment created before by runing this command in your terminal.
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda activate tensorflow
</code></pre></div>    </div>
  </li>
  <li>Second, use <code class="highlighter-rouge">pip</code> to install tensorflow for CPU only.
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install tensorflow
</code></pre></div>    </div>
    <p>And now, if you only want to use CPU for tensorflow, you have finished.
If you want to use a GPU, just change it to this.</p>
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install tensorflow-gpu
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="gpu-support">GPU support</h2>
<p>There is something a little troublesome that you need CUDA and CuDNN to make GPU support for your tensorflow-gpu.</p>

<h3 id="install-cuda">Install CUDA</h3>
<p>Make sure that the versions of Tensorflow and CUDA are compatible, otherwise you will have much trouble. To check if the version of CUDA you have is campatible with your Tensorflow, go to the offical website of <a href="https://www.tensorflow.org/">Tensorflow</a> for more information.</p>

<p>As for the installation of CUDA, you will get installation file from <a href="https://developer.nvidia.com/cuda-toolkit">offcial website</a>. Just run it and follow the guidance.</p>

<p>After CUDA has been installed, remember to add the directory of CUDA to your PATH and LD_LIBRARY_PATH. Of course, you can change .bashrc file in your HOME directory. But do you remember anaconda? It will be a better choice that you do this by anaconda.</p>

<p>Here are the details.</p>

<ol>
  <li>Fisrt, change the directory to tensorflow enviroment. (Here, my anaconda3 is justed in the HOME directory.)</li>
</ol>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/anaconda3/envs/tensorflow
</code></pre></div></div>

<ol>
  <li>Second, make some directory and go into it.
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mkdir <span class="nt">-p</span> etc/conda/activate.d
<span class="nb">cd </span>etc/conda/activate.d
</code></pre></div>    </div>
  </li>
  <li>Here, create a file <code class="highlighter-rouge">env_var.sh</code> and write something as below.
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
<span class="c"># CUDA10.0</span>
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>~/local/cuda-10.0/bin:<span class="nv">$PATH</span>
<span class="nb">export </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span>~/local/cuda-10.0/lib64:<span class="nv">$LD_LIBRARY_PATH</span>
</code></pre></div>    </div>
    <p><strong>Note: you should remember where you install your CUDA. Here, for me, it’s in <code class="highlighter-rouge">~/local/cuda-10.0</code>. Don’t copy completely.</strong></p>
  </li>
</ol>

<h4 id="some-explanation-about-nvidia-driver">Some explanation about nvidia-driver</h4>
<p>Every version of CUDA needs a specific lowest version of nvidia-driver. To install a new nvidia-driver, you need a root permission. So, if you find that the version of nvidia-driver is not high enough, just contact your administrators for help.</p>

<h3 id="install-cudnn">Install CuDNN</h3>
<p>Installation of CuDNN is much easier than that of CUDA because anaconda allows you to do it by using just one command.</p>

<ol>
  <li>First, activate your enviroment.
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda activate tensorflow
</code></pre></div>    </div>
  </li>
  <li>Second, search cudnn using conda.
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda search cudnn
</code></pre></div>    </div>
  </li>
  <li>Finally, choose the version and build you need and install it.
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conda install <span class="nv">cudnn</span><span class="o">=</span>7.3.1<span class="o">=</span>cuda10.0_0
</code></pre></div>    </div>
  </li>
</ol>

<p>Now, CuDNN has been installed.</p>

<h2 id="have-a-test">Have a test</h2>
<p>Make sure the tensorflow enviroment has been activated and then run python in your termial.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python
</code></pre></div></div>

<p>In python console, run</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="n">tf</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">is_gpu_available</span><span class="p">()</span>
</code></pre></div></div>

<p>If it returns True, congratulations, everying’s fine!</p>
